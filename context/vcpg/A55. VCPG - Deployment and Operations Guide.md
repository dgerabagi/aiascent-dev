# Artifact A55: VCPG - Deployment and Operations Guide (MVP Local Deployment)

# Date Created: C6

# Author: AI Model

  - **Description:** A technical guide for deploying the VCPG platform to the initial MVP environment (local hardware), covering infrastructure setup, configuration, and operational procedures.
  - **Tags:** deployment, operations, devops, infrastructure, docker-compose, networking

## 1\. Overview

This guide details the procedures for deploying the Virtual Cyber Proving Ground (VCPG) MVP to the specified local hardware environment. This initial deployment focuses on a single-host setup for the VCPG platform and scenario execution, with a separate host for the AI services.

## 2\. Target Environment Specification

(Based on user-provided details in C6)

### 2.1. VCPG Host (Laptop)

  - **Role:** Runs the VCPG platform services (Backend, DB, Redis) and the Docker Engine for scenario virtualization.
  - **Hardware:** Ryzen 7 7735HS (8C/16T), 64 GB DDR5 RAM, 2TB NVMe SSD.
  - **Internal IP:** 192.168.1.221
  - **OS:** (Assumed) Windows with WSL2/Docker Desktop, or Linux.

### 2.2. AI Services Host (Closet PC)

  - **Role:** Runs the LLM, Embedding, and TTS models and their respective API servers.
  - **Internal IP:** 192.168.1.85
  - **OS:** (Assumed) Windows or Linux capable of running the AI models (See A135).

### 2.3. Network Configuration

  - **Router:** AT\&T Router.
  - **Public IP:** 99.6.242.219.
  - **Connectivity:** Both hosts are on the same local network (192.168.1.0/24).

## 3\. Deployment Strategy (MVP)

We will use **Docker Compose** for orchestrating the VCPG platform services on the VCPG Host. The scenario environments will be managed by the Docker Engine running on the same host.

## 4\. Step-by-Step Deployment Guide

### 4.1. AI Services Host Setup (192.168.1.85)

1.  **Model Deployment:** Deploy the LLM, Embedding, and TTS models following the established procedures (Referencing A135/A185).
2.  **API Endpoints:** Verify the API endpoints are accessible from the local network.
      - LLM API (e.g., `http://192.168.1.85:1234/v1/completions`)
      - Embedding API (e.g., `http://192.168.1.85:8001/embed`)
      - TTS API (e.g., `http://192.168.1.85:5002/api/tts`)
3.  **Firewall Configuration:** Ensure the host firewall allows inbound traffic on the necessary ports (1234, 8001, 5002) from the VCPG Host.

### 4.2. VCPG Host Setup (192.168.1.221)

1.  **Prerequisites:** Install Docker (Desktop or Engine), Git, and Node.js (See A16).
2.  **Clone Repository:** Clone the VCPG codebase.
    ```bash
    git clone <repository_url>
    cd VCPG-Platform
    ```
3.  **Install Dependencies:**
    ```bash
    npm install
    ```
4.  **Configure Environment Variables:**
      - Create the `.env` file for the backend (`apps/backend/.env`).
      - Configure the database and Redis connections (using the `docker-compose.yml` service names).
      - **Crucially, configure the AI service URLs to point to the AI Host:**
        ```dotenv
        # ... other variables ...
        LLM_API_URL=http://192.168.1.85:1234/v1/completions
        EMBEDDING_API_URL=http://192.168.1.85:8001/embed
        TTS_API_URL=http://192.168.1.85:5002/api/tts
        # ...
        ```
5.  **Build the Application:** Build the frontend and backend applications for production.
    ```bash
    npm run build
    ```
6.  **Start Infrastructure Services:** Start PostgreSQL and Redis using the development `docker-compose.yml`.
    ```bash
    docker-compose up -d
    ```
7.  **Database Migration:** Apply the database schema migrations.
    ```bash
    npx prisma migrate deploy
    ```
8.  **Start VCPG Services:** Start the production Node.js servers. (A production `docker-compose.prod.yml` or a process manager like PM2 should be used for a robust deployment, but for initial MVP testing, `npm run start` can be used).
    ```bash
    npm run start # Or use PM2/Docker Compose production configuration
    ```

### 4.3. Network Access Configuration

#### Local Network Access

The VCPG platform should now be accessible from the local network at the VCPG Host's IP (e.g., `http://192.168.1.221:3000`).

#### Public Access (Optional, for external demonstration)

To make the platform accessible from the internet.

1.  **Router Configuration:** Log in to the AT\&T Router.
2.  **Port Forwarding:** Forward the desired external port (e.g., 80/443) to the VCPG Host's internal IP (192.168.1.221) and the application port (e.g., 3000).
3.  **Security Warning:** Exposing a development platform directly to the internet carries risks. Ensure strong authentication is enforced. For a secure public deployment, a reverse proxy (e.g., Nginx, Caddy) should be used on the VCPG Host to handle TLS termination.

## 5\. Operational Procedures

### 5.1. Monitoring

  - **Platform Services:** Monitor the logs of the NestJS application and the Docker containers (PostgreSQL, Redis).
  - **Resource Utilization:** Monitor the CPU, RAM, and Disk usage on the VCPG Host, as high concurrency may strain the resources (See A57).
  - **AI Services:** Monitor the status and resource usage on the AI Services Host.

### 5.2. Updating the Platform

1.  **Pull Changes:** `git pull` on the VCPG Host.
2.  **Install Dependencies:** `npm install`.
3.  **Rebuild:** `npm run build`.
4.  **Database Migration (if necessary):** `npx prisma migrate deploy`.
5.  **Restart Services:** Restart the NestJS application.

### 5.3. Managing Scenario Images

  - The Docker Engine on the VCPG Host must have the necessary scenario images available.
  - Periodically pull updated images or build new ones as content is developed.
    ```bash
    docker pull <image_name>